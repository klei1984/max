<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="589px" preserveAspectRatio="none" style="width:504px;height:589px;background:none;" version="1.1" viewBox="0 0 504 589" width="504px" zoomAndPan="magnify"><defs/><g><ellipse cx="176.5" cy="15" fill="#000000" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#FFFFFF" height="33.9688" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="131" x="111" y="45"/><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="111" x="121" y="66.1387">Get ECB slot index</text><rect fill="#FFFFFF" height="47.9375" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="141" x="106" y="142.9688"/><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="105" x="116" y="164.1074">Busy wait for ECB</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="121" x="116" y="178.0762">slot to become free</text><polygon fill="#FFFFFF" points="130.5,98.9688,222.5,98.9688,234.5,110.9688,222.5,122.9688,130.5,122.9688,118.5,110.9688,130.5,98.9688" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="92" x="130.5" y="114.7769">ECB slot in use?</text><polygon fill="#FFFFFF" points="128,232.9063,225,232.9063,237,244.9063,225,256.9063,128,256.9063,116,244.9063,128,232.9063" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="97" x="128" y="248.7144">ECB result code?</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="45" x="71" y="242.312">success</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="52" x="237" y="242.312">any error</text><rect fill="#FFFFFF" height="33.9688" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="147" x="32.5" y="316.5156"/><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="127" x="42.5" y="337.6543">Busy wait for timeout</text><polygon fill="#FFFFFF" points="43,266.9063,169,266.9063,181,279.7109,169,292.5156,43,292.5156,31,279.7109,43,266.9063" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="126" x="43" y="277.1167">Elapsed time since last</text><text fill="#000000" font-family="Verdana" font-size="11" lengthAdjust="spacing" textLength="113" x="43" y="289.9214">Tx request &gt; 1 ms?</text><path d="M296.5,266.9063 L296.5,290.6055 L276.5,294.6055 L296.5,298.6055 L296.5,322.3047 A0,0 0 0 0 296.5,322.3047 L497.5,322.3047 A0,0 0 0 0 497.5,322.3047 L497.5,276.9063 L487.5,266.9063 L296.5,266.9063 A0,0 0 0 0 296.5,266.9063 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M487.5,266.9063 L487.5,276.9063 L497.5,276.9063 L487.5,266.9063 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="180" x="302.5" y="283.9731">atexit() functions are called,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="179" x="302.5" y="299.106">but many resources are not</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="102" x="302.5" y="314.2388">closed properly.</text><rect fill="#FFFFFF" height="33.9688" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="59" x="217.5" y="277.6211"/><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="39" x="227.5" y="298.7598">exit(1)</text><ellipse cx="247" cy="368.3047" fill="#FFFFFF" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="247" cy="368.3047" fill="#000000" rx="6" ry="6" style="stroke:#7F7F7F;stroke-width:1.0;"/><rect fill="#FFFFFF" height="33.9688" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="94" x="129.5" y="399.3047"/><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="74" x="139.5" y="420.4434">Prepare ECB</text><path d="M258,457.6914 L258,466.2578 L238,470.2578 L258,474.2578 L258,482.8242 A0,0 0 0 0 258,482.8242 L459,482.8242 A0,0 0 0 0 459,482.8242 L459,467.6914 L449,457.6914 L258,457.6914 A0,0 0 0 0 258,457.6914 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M449,457.6914 L449,467.6914 L459,467.6914 L449,457.6914 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="180" x="264" y="474.7583">DPMI Service Call (INT 7A, 3)</text><rect fill="#FFFFFF" height="33.9688" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="123" x="115" y="453.2734"/><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="103" x="125" y="474.4121">SendPacket(ECB)</text><rect fill="#FFFFFF" height="33.9688" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.0;" width="154" x="99.5" y="507.2422"/><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="134" x="109.5" y="528.3809">Update ECB slot index</text><ellipse cx="176.5" cy="572.2109" fill="#FFFFFF" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="176.5" cy="572.2109" fill="#000000" rx="6" ry="6" style="stroke:#7F7F7F;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="176.5" x2="176.5" y1="25" y2="45"/><polygon fill="#000000" points="172.5,35,176.5,45,180.5,35,176.5,39" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="176.5" x2="176.5" y1="122.9688" y2="142.9688"/><polygon fill="#000000" points="172.5,132.9688,176.5,142.9688,180.5,132.9688,176.5,136.9688" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="176.5" x2="176.5" y1="190.9063" y2="200.9063"/><line style="stroke:#000000;stroke-width:1.5;" x1="176.5" x2="259" y1="200.9063" y2="200.9063"/><polygon fill="#000000" points="255,164.9375,259,154.9375,263,164.9375,259,160.9375" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="259" x2="259" y1="110.9688" y2="200.9063"/><line style="stroke:#000000;stroke-width:1.5;" x1="259" x2="234.5" y1="110.9688" y2="110.9688"/><polygon fill="#000000" points="244.5,106.9688,234.5,110.9688,244.5,114.9688,240.5,110.9688" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="118.5" x2="94" y1="110.9688" y2="110.9688"/><polygon fill="#000000" points="90,150.9375,94,160.9375,98,150.9375,94,154.9375" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="94" x2="94" y1="110.9688" y2="212.9063"/><line style="stroke:#000000;stroke-width:1.5;" x1="94" x2="176.5" y1="212.9063" y2="212.9063"/><line style="stroke:#000000;stroke-width:1.5;" x1="176.5" x2="176.5" y1="212.9063" y2="232.9063"/><polygon fill="#000000" points="172.5,222.9063,176.5,232.9063,180.5,222.9063,176.5,226.9063" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="176.5" x2="176.5" y1="78.9688" y2="98.9688"/><polygon fill="#000000" points="172.5,88.9688,176.5,98.9688,180.5,88.9688,176.5,92.9688" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="106" x2="106" y1="292.5156" y2="316.5156"/><polygon fill="#000000" points="102,306.5156,106,316.5156,110,306.5156,106,310.5156" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="106" x2="106" y1="350.4844" y2="362.4844"/><line style="stroke:#000000;stroke-width:1.5;" x1="106" x2="193" y1="362.4844" y2="362.4844"/><polygon fill="#000000" points="189,331.0977,193,321.0977,197,331.0977,193,327.0977" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="193" x2="193" y1="279.7109" y2="362.4844"/><line style="stroke:#000000;stroke-width:1.5;" x1="193" x2="181" y1="279.7109" y2="279.7109"/><polygon fill="#000000" points="191,275.7109,181,279.7109,191,283.7109,187,279.7109" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="31" x2="19" y1="279.7109" y2="279.7109"/><polygon fill="#000000" points="15,322.5078,19,332.5078,23,322.5078,19,326.5078" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="19" x2="19" y1="279.7109" y2="384.3047"/><line style="stroke:#000000;stroke-width:1.5;" x1="19" x2="176.5" y1="384.3047" y2="384.3047"/><line style="stroke:#000000;stroke-width:1.5;" x1="176.5" x2="176.5" y1="384.3047" y2="399.3047"/><polygon fill="#000000" points="172.5,389.3047,176.5,399.3047,180.5,389.3047,176.5,393.3047" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="247" x2="247" y1="311.5898" y2="357.3047"/><polygon fill="#000000" points="243,347.3047,247,357.3047,251,347.3047,247,351.3047" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="116" x2="106" y1="244.9063" y2="244.9063"/><line style="stroke:#000000;stroke-width:1.5;" x1="106" x2="106" y1="244.9063" y2="266.9063"/><polygon fill="#000000" points="102,256.9063,106,266.9063,110,256.9063,106,260.9063" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="237" x2="247" y1="244.9063" y2="244.9063"/><line style="stroke:#000000;stroke-width:1.5;" x1="247" x2="247" y1="244.9063" y2="277.6211"/><polygon fill="#000000" points="243,267.6211,247,277.6211,251,267.6211,247,271.6211" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="176.5" x2="176.5" y1="433.2734" y2="453.2734"/><polygon fill="#000000" points="172.5,443.2734,176.5,453.2734,180.5,443.2734,176.5,447.2734" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="176.5" x2="176.5" y1="487.2422" y2="507.2422"/><polygon fill="#000000" points="172.5,497.2422,176.5,507.2422,180.5,497.2422,176.5,501.2422" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="176.5" x2="176.5" y1="541.2109" y2="561.2109"/><polygon fill="#000000" points="172.5,551.2109,176.5,561.2109,180.5,551.2109,176.5,555.2109" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[5e488220d78cc3cec3a965ec8c69d823]
@startuml
!theme plain
start
:Get ECB slot index;

while (ECB slot in use?)
  :Busy wait for ECB\nslot to become free;
endwhile

if (ECB result code?) then (success)
  while (Elapsed time since last\nTx request > 1 ms?)
    :Busy wait for timeout;
  endwhile
else (any error)
  :exit(1);
  note right: atexit() functions are called,\nbut many resources are not\nclosed properly.
  stop
endif

:Prepare ECB;

:SendPacket(ECB);
note right: DPMI Service Call (INT 7A, 3)

:Update ECB slot index;

stop
@enduml

@startuml







<style>
  root {
    BackgroundColor white
    FontColor black
    FontName Verdana
    HyperLinkColor blue
    LineColor black
    LineThickness 1
    Margin 5
  }
  caption {
    LineThickness 0
  }
  footer {
    LineThickness 0
  }
  header {
    LineThickness 0
  }
  node {
    MaximumWidth 300
  }
  title {
    FontSize 22
    LineThickness 0
  }
</style>

skinparam ArrowLollipopColor black
skinparam BackgroundColor white
skinparam DefaultFontName Verdana
skinparam DefaultMonospacedFontName Courier
skinparam LifelineStrategy nosolid
skinparam ParticipantPadding 10
skinparam SequenceLifeLineBorderColor black
skinparam Shadowing false
skinparam UseBetaStyle true

skinparam Activity {
  BackgroundColor white
  BarColor black
  BorderColor black
  FontColor black
  FontName Verdana
}
skinparam Boundary {
  FontColor black
}
skinparam Box {
  Padding 5
}
skinparam CircledCharacter {
  FontColor black
  FontName Courier
  Radius 9
}
skinparam Class {
  BackgroundColor white
  BorderColor black
  FontColor black
  FontName Verdana
}
skinparam ClassAttribute {
  FontColor black
  FontName Verdana
}
skinparam ClassStereotype {
  FontColor black
  FontName Verdana
}
skinparam Footer {
  FontColor black
  FontName Verdana
}
skinparam Header {
  FontColor black
  FontName Verdana
}
skinparam Hyperlink {
  Color blue
}
skinparam IconPackage {
  Color black
  BackgroundColor white
}
skinparam IconPrivate {
  Color black
  BackgroundColor white
}
skinparam IconProtected {
  Color black
  BackgroundColor white
}
skinparam IconPublic {
  Color black
  BackgroundColor white
}
skinparam Note {
  FontColor black
  FontName Verdana
}
skinparam Object {
  BorderColor black
}
skinparam Package {
  BorderColor black
  FontColor black
  FontName Verdana
}
skinparam State {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeA {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeC {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeE {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeI {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeN {
  BackgroundColor white
  BorderColor black
}
skinparam UseCaseStereoType {
  FontColor black
  FontName Verdana
}
start
:Get ECB slot index;

while (ECB slot in use?)
  :Busy wait for ECB\nslot to become free;
endwhile

if (ECB result code?) then (success)
  while (Elapsed time since last\nTx request > 1 ms?)
    :Busy wait for timeout;
  endwhile
else (any error)
  :exit(1);
  note right: atexit() functions are called,\nbut many resources are not\nclosed properly.
  stop
endif

:Prepare ECB;

:SendPacket(ECB);
note right: DPMI Service Call (INT 7A, 3)

:Update ECB slot index;

stop
@enduml

PlantUML version 1.2021.16beta1(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>